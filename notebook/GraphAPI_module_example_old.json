{
	"name": "GraphAPI_module_example_old",
	"properties": {
		"folder": {
			"name": "Archive"
		},
		"nbformat": 4,
		"nbformat_minor": 2,
		"bigDataPool": {
			"referenceName": "medium",
			"type": "BigDataPoolReference"
		},
		"sessionProperties": {
			"driverMemory": "56g",
			"driverCores": 8,
			"executorMemory": "56g",
			"executorCores": 8,
			"numExecutors": 4,
			"conf": {
				"spark.dynamicAllocation.enabled": "false",
				"spark.dynamicAllocation.minExecutors": "4",
				"spark.dynamicAllocation.maxExecutors": "4"
			}
		},
		"metadata": {
			"saveOutput": true,
			"synapse_widget": {
				"version": "0.1",
				"state": {
					"a2b7faa7-cf6c-40b8-9693-e2991f1251ca": {
						"type": "Synapse.DataFrame",
						"sync_state": {
							"table": {
								"rows": [
									{
										"0": "Long",
										"1": "Abigail",
										"2": "abigaillong3@contosoisd3.onmicrosoft.com",
										"3": "0d444980-3123-46f4-85d3-6f49e4619ea5"
									},
									{
										"0": "Smith",
										"1": "Abigail",
										"2": "abigailsmith35@contosoisd3.onmicrosoft.com",
										"3": "c19234e7-a816-41af-9524-4be4092fc559"
									},
									{
										"0": "Admin",
										"1": "Global",
										"2": "admin@contosoisd3.onmicrosoft.com",
										"3": "7951c64a-b45d-4adb-8842-5e7ab60d17e1"
									},
									{
										"0": "Jordan",
										"1": "Adrian",
										"2": "adrianjordan15@contosoisd3.onmicrosoft.com",
										"3": "7a2ca37f-d1f3-4be8-8abe-8711d4eea8d6"
									},
									{
										"2": "agundapaneni_microsoft.com#EXT#@contosoisd3.onmicrosoft.com",
										"3": "34b26f30-cbfc-47ec-9131-27fef4433705"
									},
									{
										"0": "Long",
										"1": "Amanda",
										"2": "amandalong47@contosoisd3.onmicrosoft.com",
										"3": "154f2b2c-9e73-4ecc-917e-06c0e440ea15"
									},
									{
										"0": "Berger",
										"1": "Amber",
										"2": "amberberger79@contosoisd3.onmicrosoft.com",
										"3": "dbc10b91-8d2c-4cf2-ac08-985ad3b4d6b4"
									},
									{
										"0": "Buchanan",
										"1": "Amber",
										"2": "amberbuchanan5@contosoisd3.onmicrosoft.com",
										"3": "3f901837-788d-407b-b6e5-3dd9018011fe"
									},
									{
										"0": "Cook",
										"1": "Amber",
										"2": "ambercook62@contosoisd3.onmicrosoft.com",
										"3": "8ec9eba7-aab5-4f79-b798-47320dbbef0d"
									},
									{
										"0": "Price",
										"1": "Amy",
										"2": "amyprice29@contosoisd3.onmicrosoft.com",
										"3": "ce02f59b-7ab4-426d-be15-f831bef543a8"
									}
								],
								"schema": [
									{
										"key": "0",
										"name": "surname",
										"type": "string"
									},
									{
										"key": "1",
										"name": "givenName",
										"type": "string"
									},
									{
										"key": "2",
										"name": "userPrincipalName",
										"type": "string"
									},
									{
										"key": "3",
										"name": "id",
										"type": "string"
									}
								]
							},
							"isSummary": false,
							"language": "scala"
						},
						"persist_state": {
							"view": {
								"type": "details",
								"chartOptions": {
									"chartType": "bar",
									"aggregationType": "count",
									"categoryFieldKeys": [
										"0"
									],
									"seriesFieldKeys": [
										"0"
									],
									"isStacked": false
								}
							}
						}
					},
					"5d76ebf7-2413-48c3-a788-017c225a525f": {
						"type": "Synapse.DataFrame",
						"sync_state": {
							"table": {
								"rows": [
									{
										"0": "2021-09-28",
										"1": "180",
										"2": "ashleytodd20@contosoisd3.onmicrosoft.com",
										"3": "0",
										"4": "0",
										"5": "0",
										"6": "0",
										"7": "PT0S"
									},
									{
										"0": "2021-09-28",
										"1": "180",
										"2": "paigetaylor11@contosoisd3.onmicrosoft.com",
										"3": "0",
										"4": "0",
										"5": "0",
										"6": "0",
										"7": "PT0S"
									},
									{
										"0": "2021-09-28",
										"1": "180",
										"2": "joshuaelliott18@contosoisd3.onmicrosoft.com",
										"3": "0",
										"4": "0",
										"5": "0",
										"6": "0",
										"7": "PT0S"
									},
									{
										"0": "2021-09-28",
										"1": "180",
										"2": "annaalvarado60@contosoisd3.onmicrosoft.com",
										"3": "0",
										"4": "0",
										"5": "0",
										"6": "0",
										"7": "PT0S"
									},
									{
										"0": "2021-09-28",
										"1": "180",
										"2": "stacythompson16@contosoisd3.onmicrosoft.com",
										"3": "0",
										"4": "0",
										"5": "0",
										"6": "0",
										"7": "PT0S"
									},
									{
										"0": "2021-09-28",
										"1": "180",
										"2": "lydiahunt39@contosoisd3.onmicrosoft.com",
										"3": "0",
										"4": "0",
										"5": "0",
										"6": "0",
										"7": "PT0S"
									},
									{
										"0": "2021-09-28",
										"1": "180",
										"2": "christinahanna78@contosoisd3.onmicrosoft.com",
										"3": "0",
										"4": "0",
										"5": "0",
										"6": "0",
										"7": "PT0S"
									},
									{
										"0": "2021-09-28",
										"1": "180",
										"2": "stevenlarsen30@contosoisd3.onmicrosoft.com",
										"3": "0",
										"4": "0",
										"5": "0",
										"6": "0",
										"7": "PT0S"
									},
									{
										"0": "2021-09-28",
										"1": "180",
										"2": "annaalvarado10@contosoisd3.onmicrosoft.com",
										"3": "0",
										"4": "0",
										"5": "0",
										"6": "0",
										"7": "PT0S"
									},
									{
										"0": "2021-09-28",
										"1": "180",
										"2": "zacharyjohnson64@contosoisd3.onmicrosoft.com",
										"3": "0",
										"4": "0",
										"5": "0",
										"6": "0",
										"7": "PT0S"
									}
								],
								"schema": [
									{
										"key": "0",
										"name": "reportRefreshDate",
										"type": "string"
									},
									{
										"key": "1",
										"name": "reportPeriod",
										"type": "string"
									},
									{
										"key": "2",
										"name": "userPrincipalName",
										"type": "string"
									},
									{
										"key": "3",
										"name": "privateChatMessageCount",
										"type": "int"
									},
									{
										"key": "4",
										"name": "teamChatMessageCount",
										"type": "int"
									},
									{
										"key": "5",
										"name": "meetingsAttendedCount",
										"type": "int"
									},
									{
										"key": "6",
										"name": "meetingCount",
										"type": "int"
									},
									{
										"key": "7",
										"name": "audioDuration",
										"type": "string"
									}
								]
							},
							"isSummary": false,
							"language": "scala"
						},
						"persist_state": {
							"view": {
								"type": "details",
								"chartOptions": {
									"chartType": "bar",
									"aggregationType": "sum",
									"categoryFieldKeys": [
										"0"
									],
									"seriesFieldKeys": [
										"3"
									],
									"isStacked": false
								}
							}
						}
					},
					"8d120580-30ac-480b-b8a6-38d96b34b25a": {
						"type": "Synapse.DataFrame",
						"sync_state": {
							"table": {
								"rows": [
									{
										"0": "2021-09-28",
										"1": "180",
										"2": "ashleytodd20@contosoisd3.onmicrosoft.com",
										"3": "17",
										"4": "11",
										"5": "30",
										"6": "30",
										"7": "0:30"
									},
									{
										"0": "2021-09-28",
										"1": "180",
										"2": "paigetaylor11@contosoisd3.onmicrosoft.com",
										"3": "81",
										"4": "50",
										"5": "28",
										"6": "28",
										"7": "1:00"
									},
									{
										"0": "2021-09-28",
										"1": "180",
										"2": "joshuaelliott18@contosoisd3.onmicrosoft.com",
										"3": "58",
										"4": "32",
										"5": "47",
										"6": "47",
										"7": "1:00"
									},
									{
										"0": "2021-09-28",
										"1": "180",
										"2": "annaalvarado60@contosoisd3.onmicrosoft.com",
										"3": "95",
										"4": "7",
										"5": "9",
										"6": "9",
										"7": "2:00"
									},
									{
										"0": "2021-09-28",
										"1": "180",
										"2": "stacythompson16@contosoisd3.onmicrosoft.com",
										"3": "21",
										"4": "13",
										"5": "11",
										"6": "11",
										"7": "0:30"
									},
									{
										"0": "2021-09-28",
										"1": "180",
										"2": "lydiahunt39@contosoisd3.onmicrosoft.com",
										"3": "37",
										"4": "37",
										"5": "32",
										"6": "32",
										"7": "1:30"
									},
									{
										"0": "2021-09-28",
										"1": "180",
										"2": "christinahanna78@contosoisd3.onmicrosoft.com",
										"3": "81",
										"4": "46",
										"5": "6",
										"6": "6",
										"7": "2:00"
									},
									{
										"0": "2021-09-28",
										"1": "180",
										"2": "stevenlarsen30@contosoisd3.onmicrosoft.com",
										"3": "71",
										"4": "48",
										"5": "30",
										"6": "30",
										"7": "1:00"
									},
									{
										"0": "2021-09-28",
										"1": "180",
										"2": "annaalvarado10@contosoisd3.onmicrosoft.com",
										"3": "72",
										"4": "33",
										"5": "2",
										"6": "2",
										"7": "1:00"
									},
									{
										"0": "2021-09-28",
										"1": "180",
										"2": "zacharyjohnson64@contosoisd3.onmicrosoft.com",
										"3": "31",
										"4": "50",
										"5": "1",
										"6": "1",
										"7": "1:00"
									}
								],
								"schema": [
									{
										"key": "0",
										"name": "reportRefreshDate",
										"type": "string"
									},
									{
										"key": "1",
										"name": "reportPeriod",
										"type": "string"
									},
									{
										"key": "2",
										"name": "userPrincipalName",
										"type": "string"
									},
									{
										"key": "3",
										"name": "privateChatMessageCount",
										"type": "int"
									},
									{
										"key": "4",
										"name": "teamChatMessageCount",
										"type": "int"
									},
									{
										"key": "5",
										"name": "meetingsAttendedCount",
										"type": "int"
									},
									{
										"key": "6",
										"name": "meetingCount",
										"type": "int"
									},
									{
										"key": "7",
										"name": "audioDuration",
										"type": "string"
									}
								]
							},
							"isSummary": false,
							"language": "scala"
						},
						"persist_state": {
							"view": {
								"type": "details",
								"chartOptions": {
									"chartType": "bar",
									"aggregationType": "sum",
									"categoryFieldKeys": [
										"0"
									],
									"seriesFieldKeys": [
										"3"
									],
									"isStacked": false
								}
							}
						}
					},
					"d4da3f00-fc69-4a2a-ae32-f321cff24a61": {
						"type": "Synapse.DataFrame",
						"sync_state": {
							"table": {
								"rows": [
									{
										"0": "2021-09-27",
										"1": "gloriafowler49@contosoisd3.onmicrosoft.com",
										"2": "",
										"14": "[{\"reportPeriod\":180,\"windows\":false,\"mac\":false,\"mobile\":false,\"web\":false,\"outlook\":false,\"word\":false,\"excel\":false,\"powerPoint\":false,\"oneNote\":false,\"teams\":false,\"outlookWindows\":false,\"wordWindows\":false,\"excelWindows\":false,\"powerPointWindows\":false,\"oneNoteWindows\":false,\"teamsWindows\":false,\"outlookMac\":false,\"wordMac\":false,\"excelMac\":false,\"powerPointMac\":false,\"oneNoteMac\":false,\"teamsMac\":false,\"outlookMobile\":false,\"wordMobile\":false,\"excelMobile\":false,\"powerPointMobile\":false,\"oneNoteMobile\":false,\"teamsMobile\":false,\"outlookWeb\":false,\"wordWeb\":false,\"excelWeb\":false,\"powerPointWeb\":false,\"oneNoteWeb\":false,\"teamsWeb\":false}]"
									},
									{
										"0": "2021-09-27",
										"1": "johnhampton54@contosoisd3.onmicrosoft.com",
										"2": "",
										"14": "[{\"reportPeriod\":180,\"windows\":false,\"mac\":false,\"mobile\":false,\"web\":false,\"outlook\":false,\"word\":false,\"excel\":false,\"powerPoint\":false,\"oneNote\":false,\"teams\":false,\"outlookWindows\":false,\"wordWindows\":false,\"excelWindows\":false,\"powerPointWindows\":false,\"oneNoteWindows\":false,\"teamsWindows\":false,\"outlookMac\":false,\"wordMac\":false,\"excelMac\":false,\"powerPointMac\":false,\"oneNoteMac\":false,\"teamsMac\":false,\"outlookMobile\":false,\"wordMobile\":false,\"excelMobile\":false,\"powerPointMobile\":false,\"oneNoteMobile\":false,\"teamsMobile\":false,\"outlookWeb\":false,\"wordWeb\":false,\"excelWeb\":false,\"powerPointWeb\":false,\"oneNoteWeb\":false,\"teamsWeb\":false}]"
									},
									{
										"0": "2021-09-27",
										"1": "jenniferdavenport34@contosoisd3.onmicrosoft.com",
										"2": "",
										"14": "[{\"reportPeriod\":180,\"windows\":false,\"mac\":false,\"mobile\":false,\"web\":false,\"outlook\":false,\"word\":false,\"excel\":false,\"powerPoint\":false,\"oneNote\":false,\"teams\":false,\"outlookWindows\":false,\"wordWindows\":false,\"excelWindows\":false,\"powerPointWindows\":false,\"oneNoteWindows\":false,\"teamsWindows\":false,\"outlookMac\":false,\"wordMac\":false,\"excelMac\":false,\"powerPointMac\":false,\"oneNoteMac\":false,\"teamsMac\":false,\"outlookMobile\":false,\"wordMobile\":false,\"excelMobile\":false,\"powerPointMobile\":false,\"oneNoteMobile\":false,\"teamsMobile\":false,\"outlookWeb\":false,\"wordWeb\":false,\"excelWeb\":false,\"powerPointWeb\":false,\"oneNoteWeb\":false,\"teamsWeb\":false}]"
									},
									{
										"0": "2021-09-27",
										"1": "tj@contosoisd3.onmicrosoft.com",
										"2": "",
										"14": "[{\"reportPeriod\":180,\"windows\":false,\"mac\":false,\"mobile\":false,\"web\":false,\"outlook\":false,\"word\":false,\"excel\":false,\"powerPoint\":false,\"oneNote\":false,\"teams\":false,\"outlookWindows\":false,\"wordWindows\":false,\"excelWindows\":false,\"powerPointWindows\":false,\"oneNoteWindows\":false,\"teamsWindows\":false,\"outlookMac\":false,\"wordMac\":false,\"excelMac\":false,\"powerPointMac\":false,\"oneNoteMac\":false,\"teamsMac\":false,\"outlookMobile\":false,\"wordMobile\":false,\"excelMobile\":false,\"powerPointMobile\":false,\"oneNoteMobile\":false,\"teamsMobile\":false,\"outlookWeb\":false,\"wordWeb\":false,\"excelWeb\":false,\"powerPointWeb\":false,\"oneNoteWeb\":false,\"teamsWeb\":false}]"
									},
									{
										"0": "2021-09-27",
										"1": "davidwest41@contosoisd3.onmicrosoft.com",
										"2": "",
										"14": "[{\"reportPeriod\":180,\"windows\":false,\"mac\":false,\"mobile\":false,\"web\":false,\"outlook\":false,\"word\":false,\"excel\":false,\"powerPoint\":false,\"oneNote\":false,\"teams\":false,\"outlookWindows\":false,\"wordWindows\":false,\"excelWindows\":false,\"powerPointWindows\":false,\"oneNoteWindows\":false,\"teamsWindows\":false,\"outlookMac\":false,\"wordMac\":false,\"excelMac\":false,\"powerPointMac\":false,\"oneNoteMac\":false,\"teamsMac\":false,\"outlookMobile\":false,\"wordMobile\":false,\"excelMobile\":false,\"powerPointMobile\":false,\"oneNoteMobile\":false,\"teamsMobile\":false,\"outlookWeb\":false,\"wordWeb\":false,\"excelWeb\":false,\"powerPointWeb\":false,\"oneNoteWeb\":false,\"teamsWeb\":false}]"
									},
									{
										"0": "2021-09-27",
										"1": "davidtaylor44@contosoisd3.onmicrosoft.com",
										"2": "",
										"14": "[{\"reportPeriod\":180,\"windows\":false,\"mac\":false,\"mobile\":false,\"web\":false,\"outlook\":false,\"word\":false,\"excel\":false,\"powerPoint\":false,\"oneNote\":false,\"teams\":false,\"outlookWindows\":false,\"wordWindows\":false,\"excelWindows\":false,\"powerPointWindows\":false,\"oneNoteWindows\":false,\"teamsWindows\":false,\"outlookMac\":false,\"wordMac\":false,\"excelMac\":false,\"powerPointMac\":false,\"oneNoteMac\":false,\"teamsMac\":false,\"outlookMobile\":false,\"wordMobile\":false,\"excelMobile\":false,\"powerPointMobile\":false,\"oneNoteMobile\":false,\"teamsMobile\":false,\"outlookWeb\":false,\"wordWeb\":false,\"excelWeb\":false,\"powerPointWeb\":false,\"oneNoteWeb\":false,\"teamsWeb\":false}]"
									},
									{
										"0": "2021-09-27",
										"1": "justincooper74@contosoisd3.onmicrosoft.com",
										"2": "",
										"14": "[{\"reportPeriod\":180,\"windows\":false,\"mac\":false,\"mobile\":false,\"web\":false,\"outlook\":false,\"word\":false,\"excel\":false,\"powerPoint\":false,\"oneNote\":false,\"teams\":false,\"outlookWindows\":false,\"wordWindows\":false,\"excelWindows\":false,\"powerPointWindows\":false,\"oneNoteWindows\":false,\"teamsWindows\":false,\"outlookMac\":false,\"wordMac\":false,\"excelMac\":false,\"powerPointMac\":false,\"oneNoteMac\":false,\"teamsMac\":false,\"outlookMobile\":false,\"wordMobile\":false,\"excelMobile\":false,\"powerPointMobile\":false,\"oneNoteMobile\":false,\"teamsMobile\":false,\"outlookWeb\":false,\"wordWeb\":false,\"excelWeb\":false,\"powerPointWeb\":false,\"oneNoteWeb\":false,\"teamsWeb\":false}]"
									},
									{
										"0": "2021-09-27",
										"1": "annaalvarado60@contosoisd3.onmicrosoft.com",
										"2": "",
										"14": "[{\"reportPeriod\":180,\"windows\":false,\"mac\":false,\"mobile\":false,\"web\":false,\"outlook\":false,\"word\":false,\"excel\":false,\"powerPoint\":false,\"oneNote\":false,\"teams\":false,\"outlookWindows\":false,\"wordWindows\":false,\"excelWindows\":false,\"powerPointWindows\":false,\"oneNoteWindows\":false,\"teamsWindows\":false,\"outlookMac\":false,\"wordMac\":false,\"excelMac\":false,\"powerPointMac\":false,\"oneNoteMac\":false,\"teamsMac\":false,\"outlookMobile\":false,\"wordMobile\":false,\"excelMobile\":false,\"powerPointMobile\":false,\"oneNoteMobile\":false,\"teamsMobile\":false,\"outlookWeb\":false,\"wordWeb\":false,\"excelWeb\":false,\"powerPointWeb\":false,\"oneNoteWeb\":false,\"teamsWeb\":false}]"
									},
									{
										"0": "2021-09-27",
										"1": "jessicaedwards33@contosoisd3.onmicrosoft.com",
										"2": "",
										"14": "[{\"reportPeriod\":180,\"windows\":false,\"mac\":false,\"mobile\":false,\"web\":false,\"outlook\":false,\"word\":false,\"excel\":false,\"powerPoint\":false,\"oneNote\":false,\"teams\":false,\"outlookWindows\":false,\"wordWindows\":false,\"excelWindows\":false,\"powerPointWindows\":false,\"oneNoteWindows\":false,\"teamsWindows\":false,\"outlookMac\":false,\"wordMac\":false,\"excelMac\":false,\"powerPointMac\":false,\"oneNoteMac\":false,\"teamsMac\":false,\"outlookMobile\":false,\"wordMobile\":false,\"excelMobile\":false,\"powerPointMobile\":false,\"oneNoteMobile\":false,\"teamsMobile\":false,\"outlookWeb\":false,\"wordWeb\":false,\"excelWeb\":false,\"powerPointWeb\":false,\"oneNoteWeb\":false,\"teamsWeb\":false}]"
									},
									{
										"0": "2021-09-27",
										"1": "abigaillong3@contosoisd3.onmicrosoft.com",
										"2": "",
										"14": "[{\"reportPeriod\":180,\"windows\":false,\"mac\":false,\"mobile\":false,\"web\":false,\"outlook\":false,\"word\":false,\"excel\":false,\"powerPoint\":false,\"oneNote\":false,\"teams\":false,\"outlookWindows\":false,\"wordWindows\":false,\"excelWindows\":false,\"powerPointWindows\":false,\"oneNoteWindows\":false,\"teamsWindows\":false,\"outlookMac\":false,\"wordMac\":false,\"excelMac\":false,\"powerPointMac\":false,\"oneNoteMac\":false,\"teamsMac\":false,\"outlookMobile\":false,\"wordMobile\":false,\"excelMobile\":false,\"powerPointMobile\":false,\"oneNoteMobile\":false,\"teamsMobile\":false,\"outlookWeb\":false,\"wordWeb\":false,\"excelWeb\":false,\"powerPointWeb\":false,\"oneNoteWeb\":false,\"teamsWeb\":false}]"
									}
								],
								"schema": [
									{
										"key": "0",
										"name": "reportRefreshDate",
										"type": "string"
									},
									{
										"key": "1",
										"name": "userPrincipalName",
										"type": "string"
									},
									{
										"key": "2",
										"name": "lastActivityDate",
										"type": "string"
									},
									{
										"key": "3",
										"name": "reportPeriod",
										"type": "string"
									},
									{
										"key": "4",
										"name": "excel",
										"type": "string"
									},
									{
										"key": "5",
										"name": "excelWeb",
										"type": "string"
									},
									{
										"key": "6",
										"name": "outlook",
										"type": "string"
									},
									{
										"key": "7",
										"name": "outlookWeb",
										"type": "string"
									},
									{
										"key": "8",
										"name": "powerPoint",
										"type": "string"
									},
									{
										"key": "9",
										"name": "powerPointWeb",
										"type": "string"
									},
									{
										"key": "10",
										"name": "teams",
										"type": "string"
									},
									{
										"key": "11",
										"name": "teamsWeb",
										"type": "string"
									},
									{
										"key": "12",
										"name": "word",
										"type": "string"
									},
									{
										"key": "13",
										"name": "wordWeb",
										"type": "string"
									},
									{
										"key": "14",
										"name": "details",
										"type": "string"
									}
								]
							},
							"isSummary": false,
							"language": "scala"
						},
						"persist_state": {
							"view": {
								"type": "details",
								"chartOptions": {
									"chartType": "bar",
									"aggregationType": "count",
									"categoryFieldKeys": [
										"0"
									],
									"seriesFieldKeys": [
										"0"
									],
									"isStacked": false
								}
							}
						}
					},
					"6b9d2bfa-2fdc-4b61-aaf4-506ff612dd62": {
						"type": "Synapse.DataFrame",
						"sync_state": {
							"table": {
								"rows": [
									{
										"0": "2021-09-27",
										"1": "gloriafowler49@contosoisd3.onmicrosoft.com",
										"2": "",
										"3": "180",
										"4": "false",
										"5": "false",
										"6": "false",
										"7": "false",
										"8": "false",
										"9": "false",
										"10": "false",
										"11": "false",
										"12": "false",
										"13": "false"
									},
									{
										"0": "2021-09-27",
										"1": "johnhampton54@contosoisd3.onmicrosoft.com",
										"2": "",
										"3": "180",
										"4": "false",
										"5": "false",
										"6": "false",
										"7": "false",
										"8": "false",
										"9": "false",
										"10": "false",
										"11": "false",
										"12": "false",
										"13": "false"
									},
									{
										"0": "2021-09-27",
										"1": "jenniferdavenport34@contosoisd3.onmicrosoft.com",
										"2": "",
										"3": "180",
										"4": "false",
										"5": "false",
										"6": "false",
										"7": "false",
										"8": "false",
										"9": "false",
										"10": "false",
										"11": "false",
										"12": "false",
										"13": "false"
									},
									{
										"0": "2021-09-27",
										"1": "tj@contosoisd3.onmicrosoft.com",
										"2": "",
										"3": "180",
										"4": "false",
										"5": "false",
										"6": "false",
										"7": "false",
										"8": "false",
										"9": "false",
										"10": "false",
										"11": "false",
										"12": "false",
										"13": "false"
									},
									{
										"0": "2021-09-27",
										"1": "davidwest41@contosoisd3.onmicrosoft.com",
										"2": "",
										"3": "180",
										"4": "false",
										"5": "false",
										"6": "false",
										"7": "false",
										"8": "false",
										"9": "false",
										"10": "false",
										"11": "false",
										"12": "false",
										"13": "false"
									},
									{
										"0": "2021-09-27",
										"1": "davidtaylor44@contosoisd3.onmicrosoft.com",
										"2": "",
										"3": "180",
										"4": "false",
										"5": "false",
										"6": "false",
										"7": "false",
										"8": "false",
										"9": "false",
										"10": "false",
										"11": "false",
										"12": "false",
										"13": "false"
									},
									{
										"0": "2021-09-27",
										"1": "justincooper74@contosoisd3.onmicrosoft.com",
										"2": "",
										"3": "180",
										"4": "false",
										"5": "false",
										"6": "false",
										"7": "false",
										"8": "false",
										"9": "false",
										"10": "false",
										"11": "false",
										"12": "false",
										"13": "false"
									},
									{
										"0": "2021-09-27",
										"1": "annaalvarado60@contosoisd3.onmicrosoft.com",
										"2": "",
										"3": "180",
										"4": "false",
										"5": "false",
										"6": "false",
										"7": "false",
										"8": "false",
										"9": "false",
										"10": "false",
										"11": "false",
										"12": "false",
										"13": "false"
									},
									{
										"0": "2021-09-27",
										"1": "jessicaedwards33@contosoisd3.onmicrosoft.com",
										"2": "",
										"3": "180",
										"4": "false",
										"5": "false",
										"6": "false",
										"7": "false",
										"8": "false",
										"9": "false",
										"10": "false",
										"11": "false",
										"12": "false",
										"13": "false"
									},
									{
										"0": "2021-09-27",
										"1": "abigaillong3@contosoisd3.onmicrosoft.com",
										"2": "",
										"3": "180",
										"4": "false",
										"5": "false",
										"6": "false",
										"7": "false",
										"8": "false",
										"9": "false",
										"10": "false",
										"11": "false",
										"12": "false",
										"13": "false"
									}
								],
								"schema": [
									{
										"key": "0",
										"name": "reportRefreshDate",
										"type": "string"
									},
									{
										"key": "1",
										"name": "userPrincipalName",
										"type": "string"
									},
									{
										"key": "2",
										"name": "lastActivityDate",
										"type": "string"
									},
									{
										"key": "3",
										"name": "reportPeriod",
										"type": "int"
									},
									{
										"key": "4",
										"name": "excel",
										"type": "boolean"
									},
									{
										"key": "5",
										"name": "excelWeb",
										"type": "boolean"
									},
									{
										"key": "6",
										"name": "outlook",
										"type": "boolean"
									},
									{
										"key": "7",
										"name": "outlookWeb",
										"type": "boolean"
									},
									{
										"key": "8",
										"name": "powerPoint",
										"type": "boolean"
									},
									{
										"key": "9",
										"name": "powerPointWeb",
										"type": "boolean"
									},
									{
										"key": "10",
										"name": "teams",
										"type": "boolean"
									},
									{
										"key": "11",
										"name": "teamsWeb",
										"type": "boolean"
									},
									{
										"key": "12",
										"name": "word",
										"type": "boolean"
									},
									{
										"key": "13",
										"name": "wordWeb",
										"type": "boolean"
									}
								]
							},
							"isSummary": false,
							"language": "scala"
						},
						"persist_state": {
							"view": {
								"type": "details",
								"chartOptions": {
									"chartType": "bar",
									"aggregationType": "sum",
									"categoryFieldKeys": [
										"0"
									],
									"seriesFieldKeys": [
										"3"
									],
									"isStacked": false
								}
							}
						}
					},
					"cd8f6063-a48e-48bd-994c-b7fe33639e19": {
						"type": "Synapse.DataFrame",
						"sync_state": {
							"table": {
								"rows": [
									{
										"0": "2021-09-27",
										"1": "gloriafowler49@contosoisd3.onmicrosoft.com",
										"2": "",
										"3": "180",
										"4": "true",
										"5": "true",
										"6": "true",
										"7": "true",
										"8": "true",
										"9": "false",
										"10": "true",
										"11": "false",
										"12": "true",
										"13": "true"
									},
									{
										"0": "2021-09-27",
										"1": "johnhampton54@contosoisd3.onmicrosoft.com",
										"2": "",
										"3": "180",
										"4": "false",
										"5": "false",
										"6": "true",
										"7": "true",
										"8": "true",
										"9": "true",
										"10": "true",
										"11": "true",
										"12": "false",
										"13": "false"
									},
									{
										"0": "2021-09-27",
										"1": "jenniferdavenport34@contosoisd3.onmicrosoft.com",
										"2": "",
										"3": "180",
										"4": "true",
										"5": "false",
										"6": "false",
										"7": "true",
										"8": "true",
										"9": "true",
										"10": "true",
										"11": "false",
										"12": "true",
										"13": "true"
									},
									{
										"0": "2021-09-27",
										"1": "tj@contosoisd3.onmicrosoft.com",
										"2": "",
										"3": "180",
										"4": "false",
										"5": "false",
										"6": "false",
										"7": "true",
										"8": "true",
										"9": "true",
										"10": "true",
										"11": "true",
										"12": "true",
										"13": "true"
									},
									{
										"0": "2021-09-27",
										"1": "davidwest41@contosoisd3.onmicrosoft.com",
										"2": "",
										"3": "180",
										"4": "true",
										"5": "false",
										"6": "false",
										"7": "true",
										"8": "false",
										"9": "false",
										"10": "true",
										"11": "true",
										"12": "true",
										"13": "false"
									},
									{
										"0": "2021-09-27",
										"1": "davidtaylor44@contosoisd3.onmicrosoft.com",
										"2": "",
										"3": "180",
										"4": "true",
										"5": "false",
										"6": "false",
										"7": "true",
										"8": "false",
										"9": "false",
										"10": "true",
										"11": "true",
										"12": "true",
										"13": "false"
									},
									{
										"0": "2021-09-27",
										"1": "justincooper74@contosoisd3.onmicrosoft.com",
										"2": "",
										"3": "180",
										"4": "true",
										"5": "false",
										"6": "false",
										"7": "true",
										"8": "true",
										"9": "false",
										"10": "true",
										"11": "true",
										"12": "true",
										"13": "false"
									},
									{
										"0": "2021-09-27",
										"1": "annaalvarado60@contosoisd3.onmicrosoft.com",
										"2": "",
										"3": "180",
										"4": "false",
										"5": "true",
										"6": "false",
										"7": "true",
										"8": "true",
										"9": "false",
										"10": "true",
										"11": "true",
										"12": "false",
										"13": "false"
									},
									{
										"0": "2021-09-27",
										"1": "jessicaedwards33@contosoisd3.onmicrosoft.com",
										"2": "",
										"3": "180",
										"4": "false",
										"5": "true",
										"6": "false",
										"7": "true",
										"8": "false",
										"9": "false",
										"10": "true",
										"11": "false",
										"12": "false",
										"13": "false"
									},
									{
										"0": "2021-09-27",
										"1": "abigaillong3@contosoisd3.onmicrosoft.com",
										"2": "",
										"3": "180",
										"4": "true",
										"5": "false",
										"6": "false",
										"7": "true",
										"8": "false",
										"9": "false",
										"10": "true",
										"11": "false",
										"12": "false",
										"13": "true"
									}
								],
								"schema": [
									{
										"key": "0",
										"name": "reportRefreshDate",
										"type": "string"
									},
									{
										"key": "1",
										"name": "userPrincipalName",
										"type": "string"
									},
									{
										"key": "2",
										"name": "lastActivityDate",
										"type": "string"
									},
									{
										"key": "3",
										"name": "reportPeriod",
										"type": "int"
									},
									{
										"key": "4",
										"name": "excel",
										"type": "string"
									},
									{
										"key": "5",
										"name": "excelWeb",
										"type": "string"
									},
									{
										"key": "6",
										"name": "outlook",
										"type": "string"
									},
									{
										"key": "7",
										"name": "outlookWeb",
										"type": "string"
									},
									{
										"key": "8",
										"name": "powerPoint",
										"type": "string"
									},
									{
										"key": "9",
										"name": "powerPointWeb",
										"type": "string"
									},
									{
										"key": "10",
										"name": "teams",
										"type": "string"
									},
									{
										"key": "11",
										"name": "teamsWeb",
										"type": "string"
									},
									{
										"key": "12",
										"name": "word",
										"type": "string"
									},
									{
										"key": "13",
										"name": "wordWeb",
										"type": "string"
									}
								]
							},
							"isSummary": false,
							"language": "scala"
						},
						"persist_state": {
							"view": {
								"type": "details",
								"chartOptions": {
									"chartType": "bar",
									"aggregationType": "sum",
									"categoryFieldKeys": [
										"0"
									],
									"seriesFieldKeys": [
										"3"
									],
									"isStacked": false
								}
							}
						}
					}
				}
			},
			"enableDebugMode": false,
			"kernelspec": {
				"name": "synapse_pyspark",
				"display_name": "Synapse PySpark"
			},
			"language_info": {
				"name": "python"
			},
			"a365ComputeOptions": {
				"id": "/subscriptions/7b9a4896-4541-483f-bdc7-d8f4ec6be3ee/resourceGroups/rg-oea-hybriddev2/providers/Microsoft.Synapse/workspaces/syn-oea-hybriddev2/bigDataPools/medium",
				"name": "medium",
				"type": "Spark",
				"endpoint": "https://syn-oea-hybriddev2.dev.azuresynapse.net/livyApi/versions/2019-11-01-preview/sparkPools/medium",
				"auth": {
					"type": "AAD",
					"authResource": "https://dev.azuresynapse.net"
				},
				"sparkVersion": "2.4",
				"nodeCount": 10,
				"cores": 8,
				"memory": 56,
				"extraHeader": null
			}
		},
		"cells": [
			{
				"cell_type": "markdown",
				"metadata": {
					"nteract": {
						"transient": {
							"deleting": false
						}
					}
				},
				"source": [
					"# Graph API Module Example \r\n",
					"This example demonstrates how to use the Graph API module to process incoming Microsoft Graph data, perform data prep, and view the data in an example Power BI dashboard.\r\n",
					"## Preface\r\n",
					"a.) Before running this notebook, you will need to change the storage account URLs to match your own, within every cell.\r\n",
					"\r\n",
					"b.) Above each of the data processing cells in each step, there is \"file viewer\" code commented out. You can uncomment this for debugging purposes, or to see the contents within each file.\r\n",
					"\r\n",
					"c.) Directly below each of the data processing cells for steps 2 and 3 (m365 and teams data), there is code for randomization of data within each of the tables. **If you wish to preserve any original data that you chose to integrate via the Graph pipeline, you must comment these out.**\r\n",
					"\r\n",
					"d.) Step 2 (Processing the M365 apps user details data) has one additional cell, in order to clean the data into the right columns. Do not comment this out.\r\n",
					"## Running the example (LAST STEP NEEDS TO BE EDITED)\r\n",
					"1.) Select your spark pool in the \"Attach to\" dropdown list above.\r\n",
					"\r\n",
					"2.) Click on \"Publish\" in the top nav bar (and wait a few seconds for the notification that says \"Publishing completed\").\r\n",
					"\r\n",
					"3.) Click on \"Run all\" at the top of this tab (and wait for the processing to complete - which can take around 5 to 10 minutes).\r\n",
					"\r\n",
					"4.) Open the dashboard in Power BI desktop and point it to your newly setup data lake (you can download the pbix from here: [techInequityDashboardContoso v2.pbix](https://github.com/microsoft/OpenEduAnalytics/blob/main/packages/ContosoISD/power_bi/techInequityDashboardContoso%20v2.pbix) )\r\n",
					"\r\n",
					"## 1.) Processing \"users\" raw data from Graph API \r\n",
					"Data is cleaned from \"users\" in stage1np of the data lake, written as a parquet, and landed in stage2np. \r\n",
					""
				],
				"attachments": null
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					},
					"collapsed": false
				},
				"source": [
					"#%%pyspark\r\n",
					"from pyspark.sql.types import StructType, StructField, StringType, IntegerType, DoubleType, ArrayType\r\n",
					"from pyspark.sql.functions import explode\r\n",
					"\r\n",
					"user_schema = StructType(fields=[\r\n",
					"    StructField('value', ArrayType(\r\n",
					"        StructType([\r\n",
					"            StructField('surname', StringType(), False),\r\n",
					"            StructField('givenName', StringType(), False),\r\n",
					"            StructField('userPrincipalName', StringType(), False),\r\n",
					"            StructField('id', StringType(), False)\r\n",
					"        ])\r\n",
					"    ))\r\n",
					"])\r\n",
					"\r\n",
					"df = spark.read.load('abfss://stage1np@stoeahybriddev2.dfs.core.windows.net/GraphAPI/users.json', format='json', schema=user_schema)\r\n",
					"df = df.select(explode('value').alias('exploded_values')).select(\"exploded_values.*\")\r\n",
					"display(df.limit(10))\r\n",
					"#display(df)\r\n",
					"\r\n",
					"# Convert the data in the JSON above to parquet and land this parquet in stage 2np\r\n",
					"#df.write.format('parquet').mode('overwrite').save('abfss://stage2np@stoeahybriddev2.dfs.core.windows.net/GraphAPI/users')\r\n",
					"\r\n",
					"# Create spark db graphapi to allow for access to the data in the data lake via SQL on-demand, and create the table \"users\".\r\n",
					"#spark.sql('CREATE DATABASE IF NOT EXISTS GRAPHAPI')\r\n",
					"#spark.sql(\"create table if not exists GraphAPI.users using PARQUET location 'abfss://stage2np@stoeahybriddev2.dfs.core.windows.net/GraphAPI/users'\")"
				],
				"attachments": null,
				"execution_count": 1
			},
			{
				"cell_type": "markdown",
				"metadata": {
					"nteract": {
						"transient": {
							"deleting": false
						}
					}
				},
				"source": [
					"## 2.) Processing \"Microsoft 365 app user detail\" raw data from Graph API\r\n",
					"Data is cleaned from \"m365_app_user_detail\" in stage1np of the data lake, written as a parquet, and landed in stage2np."
				],
				"attachments": null
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					},
					"collapsed": false
				},
				"source": [
					"from pyspark.sql.types import StructType, StructField, StringType, IntegerType, DoubleType, ArrayType, BooleanType\r\n",
					"from pyspark.sql.functions import explode, split, col, regexp_replace, rand, when\r\n",
					"\r\n",
					"m365_app_user_details_schema = StructType(fields=[\r\n",
					"    StructField('value', ArrayType(\r\n",
					"        StructType([\r\n",
					"            StructField('reportRefreshDate', StringType(), False),\r\n",
					"            StructField('userPrincipalName', StringType(), False),\r\n",
					"            StructField('lastActivityDate', StringType(), False),\r\n",
					"            StructField('reportPeriod', StringType(), False),\r\n",
					"            StructField('excel', StringType(), False),\r\n",
					"            StructField('excelWeb', StringType(), False),\r\n",
					"            StructField('outlook', StringType(), False),\r\n",
					"            StructField('outlookWeb', StringType(), False),\r\n",
					"            StructField('powerPoint', StringType(), False),\r\n",
					"            StructField('powerPointWeb', StringType(), False),\r\n",
					"            StructField('teams', StringType(), False),\r\n",
					"            StructField('teamsWeb', StringType(), False),\r\n",
					"            StructField('word', StringType(), False),\r\n",
					"            StructField('wordWeb', StringType(), False),\r\n",
					"            StructField('details', StringType())\r\n",
					"        ])\r\n",
					"    ))\r\n",
					"])\r\n",
					"\r\n",
					"df = spark.read.load('abfss://stage1np@stoeahybriddev2.dfs.core.windows.net/GraphAPI/m365_app_user_detail.json', format='json', schema=m365_app_user_details_schema)\r\n",
					"\r\n",
					"df = df.select(explode('value').alias('exploded_values')).select(\"exploded_values.*\")\r\n",
					"#df = df.select(explode('details').alias('exploded_details')).select(\"exploded_details.*\")\r\n",
					"\r\n",
					"display(df.limit(10))"
				],
				"attachments": null,
				"execution_count": 1
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					},
					"collapsed": false
				},
				"source": [
					"# This is a roundabout method (taking in details as a string rather than array), but nontheless - it works for now.\r\n",
					"\r\n",
					"# Isolate and allocate data from \"details\" to their respective columns\r\n",
					"splitDF = df.withColumn('reportPeriod', split(col('details'), ',').getItem(0)).withColumn('outlook', split(col('details'), ',').getItem(5)).withColumn('word', split(col('details'), ',').getItem(6)).withColumn('excel', split(col('details'), ',').getItem(7)).withColumn('powerPoint', split(col('details'), ',').getItem(8)).withColumn('teams', split(col('details'), ',').getItem(10)).withColumn('outlookWeb', split(col('details'), ',').getItem(29)).withColumn('wordWeb', split(col('details'), ',').getItem(30)).withColumn('excelWeb', split(col('details'), ',').getItem(31)).withColumn('powerPointWeb', split(col('details'), ',').getItem(32)).withColumn('teamsWeb', split(col('details'), ',').getItem(34))\r\n",
					"splitDF = splitDF.drop('details')\r\n",
					"\r\n",
					"# Clean the data within each column, to remove excess string pieces\r\n",
					"splitDF = splitDF.withColumn('reportPeriod', regexp_replace('reportPeriod', '\"reportPeriod\":', '')).withColumn('excel', regexp_replace('excel','\"excel\":', '')).withColumn('excelWeb', regexp_replace('excelWeb','\"excelWeb\":', '')).withColumn('outlook', regexp_replace('outlook','\"outlook\":', '')).withColumn('outlookWeb', regexp_replace('outlookWeb','\"outlookWeb\":', '')).withColumn('powerPoint', regexp_replace('powerPoint','\"powerPoint\":', '')).withColumn('powerPointWeb', regexp_replace('powerPointWeb','\"powerPointWeb\":', '')).withColumn('teams', regexp_replace('teams','\"teams\":', '')).withColumn('teamsWeb', regexp_replace('teamsWeb','\"teamsWeb\":', '')).withColumn('word', regexp_replace('word','\"word\":', '')).withColumn('wordWeb', regexp_replace('wordWeb','\"wordWeb\":', ''))\r\n",
					"splitDF = splitDF.withColumn('reportPeriod', regexp_replace('reportPeriod', '\\W+', '')).withColumn('teamsWeb', regexp_replace('teamsWeb', '\\W+', ''))\r\n",
					"\r\n",
					"# Transform the datatypes of the columns to be accurate to what they represent\r\n",
					"splitDF = splitDF.withColumn('reportPeriod', col('reportPeriod').cast(\"int\")).withColumn('excel', col('excel').cast(\"boolean\")).withColumn('excelWeb', col('excelWeb').cast(\"boolean\")).withColumn('outlook', col('outlook').cast(\"boolean\")).withColumn('outlookWeb', col('outlookWeb').cast(\"boolean\")).withColumn('powerPoint', col('powerPoint').cast(\"boolean\")).withColumn('powerPointWeb', col('powerPointWeb').cast(\"boolean\")).withColumn('teams', col('teams').cast(\"boolean\")).withColumn('teamsWeb', col('teamsWeb').cast(\"boolean\")).withColumn('word', col('word').cast(\"boolean\")).withColumn('wordWeb', col('wordWeb').cast(\"boolean\"))\r\n",
					"\r\n",
					"display(splitDF.limit(10))\r\n",
					"#splitDF.printSchema\r\n",
					"#display(splitDF)\r\n",
					""
				],
				"attachments": null,
				"execution_count": 2
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					},
					"collapsed": false
				},
				"source": [
					"# Randomization for sample data\r\n",
					"splitDF = splitDF.withColumn('excel', when(rand() > 0.3, \"true\").otherwise(\"false\")).withColumn('excelWeb', when(rand() > 0.7, \"true\").otherwise(\"false\")).withColumn('outlook', when(rand() > 0.9, \"true\").otherwise(\"false\")).withColumn('outlookWeb', when(rand() > 0.1, \"true\").otherwise(\"false\")).withColumn('powerPoint', when(rand() > 0.7, \"true\").otherwise(\"false\")).withColumn('powerPointWeb', when(rand() > 0.9, \"true\").otherwise(\"false\")).withColumn('teams', when(rand() > 0.1, \"true\").otherwise(\"false\")).withColumn('teamsWeb', when(rand() > 0.3, \"true\").otherwise(\"false\")).withColumn('word', when(rand() > 0.4, \"true\").otherwise(\"false\")).withColumn('wordWeb', when(rand() > 0.7, \"true\").otherwise(\"false\"))\r\n",
					"\r\n",
					"display(splitDF.limit(10))"
				],
				"attachments": null,
				"execution_count": 3
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					}
				},
				"source": [
					"# Convert the data in the JSON above to parquet and land this parquet in stage 2np\r\n",
					"splitDF.write.format('parquet').mode('overwrite').save('abfss://stage2np@stoeahybriddev2.dfs.core.windows.net/GraphAPI/m365_app_user_detail')\r\n",
					"\r\n",
					"# Create table \"m365_app_user_detail\" in spark db \"graphapi\" to allow for access to the data in the data lake.\r\n",
					"spark.sql(\"create table if not exists GraphAPI.m365_app_user_detail using PARQUET location 'abfss://stage2np@stoeahybriddev2.dfs.core.windows.net/GraphAPI/m365_app_user_detail'\")"
				],
				"attachments": null,
				"execution_count": 7
			},
			{
				"cell_type": "markdown",
				"metadata": {
					"nteract": {
						"transient": {
							"deleting": false
						}
					}
				},
				"source": [
					"## 3.) Processing \"Teams activity user details\" raw data from Graph API\r\n",
					"Data is cleaned from \"teams_activity_user_details\" in stage1np of the data lake, written as a parquet, and landed in stage2np."
				],
				"attachments": null
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					},
					"collapsed": false
				},
				"source": [
					"# View \"teams_activity_user_details\" JSON\r\n",
					"#%%pyspark\r\n",
					"#df = spark.read.load('abfss://stage1np@stoeahybriddev2.dfs.core.windows.net/GraphAPI/teams_activity_user_details', format='json')\r\n",
					"#display(df.limit(10))"
				],
				"attachments": null,
				"execution_count": null
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					},
					"collapsed": false
				},
				"source": [
					"from pyspark.sql.types import StructType, StructField, StringType, IntegerType, DoubleType, ArrayType, BooleanType\r\n",
					"from pyspark.sql.functions import explode, split, col, regexp_replace, rand, when, round\r\n",
					"\r\n",
					"teams_activity_user_details_schema = StructType(fields=[\r\n",
					"    StructField('value', ArrayType(\r\n",
					"        StructType([\r\n",
					"            StructField('reportRefreshDate', StringType(), False),\r\n",
					"            StructField('reportPeriod', StringType(), False),\r\n",
					"            StructField('userPrincipalName', StringType(), False),\r\n",
					"            StructField('privateChatMessageCount', IntegerType(), False),\r\n",
					"            StructField('teamChatMessageCount', IntegerType(), False),\r\n",
					"            StructField('meetingsAttendedCount', IntegerType(), False),\r\n",
					"            StructField('meetingCount', IntegerType(), False),\r\n",
					"            StructField('audioDuration', StringType(), False),\r\n",
					"        ])\r\n",
					"    ))\r\n",
					"])\r\n",
					"\r\n",
					"df = spark.read.load('abfss://stage1np@stoeahybriddev2.dfs.core.windows.net/GraphAPI/teams_activity_user_details.json', format='json', schema=teams_activity_user_details_schema)\r\n",
					"df = df.select(explode('value').alias('exploded_values')).select(\"exploded_values.*\")\r\n",
					"\r\n",
					"display(df.limit(10))\r\n",
					"#display(df)\r\n",
					""
				],
				"attachments": null,
				"execution_count": 5
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					},
					"collapsed": false
				},
				"source": [
					"# Randomization for sample data (meetingCount = meetingsAttendedCount)\r\n",
					"df = df.withColumn('privateChatMessageCount', round(rand(seed=10)*100).cast(\"int\")).withColumn('teamChatMessageCount', round(rand()*50).cast(\"int\")).withColumn('meetingsAttendedCount', round(rand(seed=20)*50).cast(\"int\")).withColumn('meetingCount', round(rand(seed=20)*50).cast(\"int\"))\r\n",
					"df = df.withColumn('audioDuration', when(rand() > 0.9, '2:00').when(rand() > 0.7, '1:30').when(rand() > 0.5, '1:00').when(rand() > 0.3, '0:30').when(rand() > 0.1, '0:15').otherwise('0:00'))\r\n",
					"\r\n",
					"display(df.limit(10))"
				],
				"attachments": null,
				"execution_count": 6
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					}
				},
				"source": [
					"# Convert the data in the JSON above to parquet and land this parquet in stage 2np\r\n",
					"df.write.format('parquet').mode('overwrite').save('abfss://stage2np@stoeahybriddev2.dfs.core.windows.net/GraphAPI/teams_activity_user_details')\r\n",
					"\r\n",
					"# Create table \"teams_activity_user_details\" in spark db \"graphapi\" to allow for access to the data in the data lake.\r\n",
					"spark.sql(\"create table if not exists GraphAPI.teams_activity_user_details using PARQUET location 'abfss://stage2np@stoeahybriddev2.dfs.core.windows.net/GraphAPI/teams_activity_user_details'\")"
				],
				"attachments": null,
				"execution_count": 8
			},
			{
				"cell_type": "markdown",
				"metadata": {
					"nteract": {
						"transient": {
							"deleting": false
						}
					}
				},
				"source": [
					"# Reset everything\r\n",
					"You can uncomment line 8 in the last cell below and run that cell to reset everything and walk through the process again.\r\n",
					"\r\n",
					"Note: remember to comment out line 8 again to prevent accidental resetting of the example"
				],
				"attachments": null
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					}
				},
				"source": [
					"%run /OEA_py_updated"
				],
				"attachments": null,
				"execution_count": 1
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					}
				},
				"source": [
					"oea = OEA()"
				],
				"attachments": null,
				"execution_count": null
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					}
				},
				"source": [
					"def reset_all_processing():\r\n",
					"    #oea.rm_if_exists(oea.stage2np + '/GraphAPI')\r\n",
					"\r\n",
					"    oea.drop_db('graphapi')\r\n",
					"\r\n",
					"# Uncomment the following line and run this cell to reset everything if you want to walk through the process again, INCLUDING THE PIPELINE INTEGRATION TRIGGER.\r\n",
					"#reset_all_processing()"
				],
				"attachments": null,
				"execution_count": null
			}
		]
	}
}